"use strict";(self.webpackChunkheadless_doc=self.webpackChunkheadless_doc||[]).push([[2089],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),l=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(i.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(n),m=a,g=d["".concat(i,".").concat(m)]||d[m]||u[m]||o;return n?r.createElement(g,p(p({ref:t},c),{},{components:n})):r.createElement(g,p({ref:t},c))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,p=new Array(o);p[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[d]="string"==typeof e?e:a,p[1]=s;for(var l=2;l<o;l++)p[l]=n[l];return r.createElement.apply(null,p)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3543:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>p,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_label:"TypeScript"},p="TypeScript",s={unversionedId:"Guides/typescript",id:"Guides/typescript",title:"TypeScript",description:"HeadstartWP offer first-class support for TypeScript. In this guide we document how to leverage TypeScript with HeadstartWP and the Next.js pages router. We also recommend reviewing the official Next.js docs for TypeScript as using default HeadstartWP project as a reference for building with TypeScript.",source:"@site/documentation/08-Guides/typescript.md",sourceDirName:"08-Guides",slug:"/Guides/typescript",permalink:"/docs/learn/Guides/typescript",draft:!1,editUrl:"https://github.com/10up/headstartwp/tree/trunk/docs/documentation/08-Guides/typescript.md",tags:[],version:"current",lastUpdatedBy:"N\xedcholas Andr\xe9",lastUpdatedAt:1717699930,formattedLastUpdatedAt:"Jun 6, 2024",frontMatter:{sidebar_label:"TypeScript"},sidebar:"tutorialSidebar",previous:{title:"Linaria (CSS-in-JS)",permalink:"/docs/learn/Guides/linaria"},next:{title:"Implementing a Youtube Facade",permalink:"/docs/learn/Guides/youtube-facade"}},i={},l=[{value:"getStaticProps, getServerSideProps and page props",id:"getstaticprops-getserversideprops-and-page-props",level:2},{value:"Recommended TS Config",id:"recommended-ts-config",level:2},{value:"Global Types",id:"global-types",level:2},{value:"Running the typecheck",id:"running-the-typecheck",level:2}],c={toc:l};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"typescript"},"TypeScript"),(0,a.kt)("p",null,"HeadstartWP offer first-class support for TypeScript. In this guide we document how to leverage TypeScript with HeadstartWP and the Next.js pages router. We also recommend reviewing the official Next.js ",(0,a.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/pages/building-your-application/configuring/typescript"},"docs for TypeScript")," as using default ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/10up/headstartwp/tree/develop/projects/wp-nextjs"},"HeadstartWP project")," as a reference for building with TypeScript."),(0,a.kt)("h2",{id:"getstaticprops-getserversideprops-and-page-props"},"getStaticProps, getServerSideProps and page props"),(0,a.kt)("p",null,"The recommended way to type ",(0,a.kt)("inlineCode",{parentName:"p"},"getStaticProps")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," is by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"satisfies")," operator. Ensure you have ",(0,a.kt)("inlineCode",{parentName:"p"},"typescript")," >= 4.9 before using ",(0,a.kt)("inlineCode",{parentName:"p"},"satisfies"),"."),(0,a.kt)("p",null,"HeadstartWP exports two types that can be used for this purpose ",(0,a.kt)("inlineCode",{parentName:"p"},"HeadlessGetStaticProps")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"HeadlessGetServerSideProps"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import type { HeadlessGetStaticProps } from '@headstartwp/next';\n\nexport const getStaticProps = (async (context) => {\n    try {\n        const settledPromises = await resolveBatch([\n            {\n                func: fetchHookData(usePost.fetcher(), context, { params: singleParams }),\n            },\n            { func: fetchHookData(useAppSettings.fetcher(), context) },\n        ]);\n\n        return addHookData(settledPromises, { revalidate: 5 * 60 });\n    } catch (e) {\n        return handleError(e, context);\n    }\n}) satisfies HeadlessGetStaticProps;\n")),(0,a.kt)("p",null,"By using HeadstartWP types you will get the ",(0,a.kt)("inlineCode",{parentName:"p"},"context")," object properly typed for HeadstartWP, for instance the ",(0,a.kt)("inlineCode",{parentName:"p"},"context.previewData")," will be typed with HeadstartWP preview data type."),(0,a.kt)("p",null,"If you are sending additional props to your page component we recommend using ",(0,a.kt)("inlineCode",{parentName:"p"},"InferGetStaticPropsType")," from Next.js."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"// `homepageSlug` will correctly be typed to `string`\nconst Homepage = ({ homePageSlug }: InferGetStaticPropsType<typeof getStaticProps>) => {\n    const params = { ...indexParams, slug: homePageSlug };\n\n    return (\n        <>\n            <PageContent params={params} />\n        </>\n    );\n};\n\nexport default Homepage;\n\n\nexport const getStaticProps = (async (context) => {\n    const hookData = [];\n    let slug = '';\n    try {\n        const appSettings = await fetchHookData(useAppSettings.fetcher(), context);\n\n        /**\n         * The static front-page can be set in the WP admin. The default one will be 'front-page'\n         */\n        slug = appSettings.data.result?.home?.slug ?? 'front-page';\n\n        hookData.push(appSettings);\n    } catch (e) {\n        if (e.name === 'EndpointError') {\n            slug = 'front-page';\n        }\n    }\n\n    try {\n        const usePost = await fetchHookData(usePost.fetcher(), context, {\n                    params: {\n                        ...indexParams,\n                        slug,\n                    },\n        });\n\n        hookData.push(...fetchBatch);\n\n        return addHookData(hookData, {\n            // TypeScript can cleverly infer the `props` type here\n            props: { homePageSlug: slug },\n            revalidate: 5 * 60,\n        });\n    } catch (e) {\n        return handleError(e, context);\n    }\n}) satisfies HeadlessGetStaticProps;\n")),(0,a.kt)("p",null,"Note that ",(0,a.kt)("inlineCode",{parentName:"p"},"addHookData")," also accepts a generic type if you need to provider a complex type def for you own props."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"return addHookData<MyCustomPropsType>(hookData, {\n    props: { homePageSlug: slug, complexDataType },\n    revalidate: 5 * 60,\n});\n")),(0,a.kt)("h2",{id:"recommended-ts-config"},"Recommended TS Config"),(0,a.kt)("p",null,"This is the recommended TS Config for working with HeadstartWP and TypeScript"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "compilerOptions": {\n    "lib": [\n      "dom",\n      "dom.iterable",\n      "esnext"\n    ],\n    "allowJs": true,\n    "skipLibCheck": true,\n    "strict": false,\n    "forceConsistentCasingInFileNames": true,\n    "noEmit": true,\n    "incremental": true,\n    "esModuleInterop": true,\n    "module": "ESNext",\n    "moduleResolution": "bundler",\n    "resolveJsonModule": true,\n    "isolatedModules": true,\n    "jsx": "preserve",\n    "noFallthroughCasesInSwitch": true,\n    "noImplicitAny": true,\n    "strictBindCallApply": true,\n    "strictNullChecks": true,\n  },\n  "include": [\n    "next-env.d.ts",\n    "**/*.ts",\n    "**/*.tsx"\n  ],\n  "exclude": [\n    "node_modules"\n  ]\n}\n')),(0,a.kt)("h2",{id:"global-types"},"Global Types"),(0,a.kt)("p",null,"We recommend using a ",(0,a.kt)("inlineCode",{parentName:"p"},"src/global.d.ts")," file when you need to add/extend types to the global scope. An example would be extending the ",(0,a.kt)("inlineCode",{parentName:"p"},"window")," global for typing third party scripts (Ads, GA etc)."),(0,a.kt)("p",null,"Make sure that ",(0,a.kt)("inlineCode",{parentName:"p"},"src/global.d.ts")," is added to your ",(0,a.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," include array."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/global.d.t"',title:'"src/global.d.t"'},"interface Window {\n  // add new types to the Window global\n}\n")),(0,a.kt)("h2",{id:"running-the-typecheck"},"Running the typecheck"),(0,a.kt)("p",null,"By default Next.js will run ",(0,a.kt)("inlineCode",{parentName:"p"},"tsc")," to validate your types. If type checking fails your build will fail. Therefore we recommend running ",(0,a.kt)("inlineCode",{parentName:"p"},"tsc --noEmit")," before commiting and/or on your CI prior to merging PRs."))}d.isMDXComponent=!0}}]);